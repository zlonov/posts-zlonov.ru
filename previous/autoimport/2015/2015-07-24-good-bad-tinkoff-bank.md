---
layout: zlonov/old_post
title: Хороший плохой Тинькофф Банк
date: 2015-07-24 12:14
author: admin
category: autoimport
tags: [AdBlock, Ghostery, банк, информационная безопасность, слежение, Тинькофф, утечка, УЦСБ]
---
Работая в компании, <a href="http://www.ussc.ru/about/" target="_blank">специализирующейся на информационной безопасности</a>, постоянно находишься в окружении <del>параноиков</del> увлечённых людей =) Но лично меня это очень радует, так как и сам такой же.

Недавно коллега Евгений Миронов обратил внимание на ежемесячную рассылку Банка Тинькофф электронных писем с информацией о выписке об операциях по карте. До июля банк присылал выписку в виде вложенного PDF-файла, а в июле решил изменить способ доставки.

[caption id="attachment_7213" align="aligncenter" width="608"]<a href="/assets/uploads/Ссылка-на-выписку.png"><img class="size-full wp-image-7213" src="/assets/uploads/Ссылка-на-выписку.png" alt="Ссылка на выписку" width="608" height="225" /></a> Ссылка на выписку[/caption]

Теперь в письме самой выписки не было - прислали лишь ссылку, где её можно посмотреть. Ссылка генерируется для каждого клиента (видимо) случайная и просто так её не подберёшь:
<blockquote>https://www.tinkoff.ru/statement/?ticket=857261EC08BA4C05BF801B11C9A0A6A26C974BD399454067BD0D8923EF510618
Вот только ссылка эта является <em>прямой</em>, т.е. открывается без запроса логина/пароля и позволяет скачать выписку любому, кто знает правильный адрес ссылки. В принципе, с точки зрения безопасности большой разницы между обоими вариантами (PDF-файл и прямая ссылка) нет, если бы не один нюанс, на который Евгений и обратил внимание.

Дело в том, что на странице банка, где размещается эта ссылка, были встроены сервисы рекламы и статистики, к которым при загрузке страницы происходило обращение.

Вот эти сервисы:
<ul>
	<li>adfocus.ru</li>
	<li>s.ytimg.com</li>
	<li>ssp-ext-bl.datamind.ru</li>
	<li>stats.g.doubleclick.net</li>
	<li>sync.pool.datamind.ru</li>
	<li>syncsw.pool.datamind.ru</li>
	<li>www.youtube.com</li>
	<li>tinkoffcreditsystems.d3.sc.omtrdc.net</li>
	<li>www.google-analytics.com</li>
	<li>top-fwz1.mail.ru</li>
	<li>www.googletagmanager.com</li>
</ul>
Получается, что фактически, любой, кто имеет доступ к статистике этих сервисов (например, их владельцы, администраторы и иной обслуживающий персонал) может увидеть в логах те самые прямые ссылки и воспользоваться ими, чтобы, не зная логина и пароля, получить доступ к выпискам клиентов банка (при условии, конечно, что клиенты пройдут по этим ссылкам).

Евгений обратился в банк и выписку по его ссылке оперативно удалили, но и только. Убедился в этом, проверив ссылку из собственного письма. Выписка прекрасно скачивалась без авторизации и сервисы были на месте:

[caption id="attachment_7214" align="aligncenter" width="215"]<a href="/assets/uploads/Некоторые-из-сервисов-на-странице-банка-Тинькофф-с-выпиской-клиента.png"><img class="size-full wp-image-7214" src="/assets/uploads/Некоторые-из-сервисов-на-странице-банка-Тинькофф-с-выпиской-клиента.png" alt="Некоторые из сервисов на странице банка Тинькофф с выпиской клиента" width="215" height="382" /></a> Некоторые из сервисов на странице банка Тинькофф с выпиской клиента[/caption]

К слову, посмотреть запросы, направляемые загружаемой страницей к внешним сервисам можно так:
<ul>
	<li>Safari: правая кнопка мыши -&gt; <em>Показать программный код страницы</em> -&gt; вкладка <em>Шкала времени</em>. Перезагрузите страницу и увидите полный список всех запросов как на скриншоте выше.</li>
	<li>Chrome: правая кнопка мыши -&gt; <em>Проверить элемент</em> -&gt; вкладка <em>Sources</em>.</li>
</ul>
Предположив, что результатом моего персонального обращения в банк станет очередное удаление одной единственной (теперь моей) выписки, обратился к ним через официальный аккаунт в Твиттере. Не сразу, но всё-таки меня там <a href="https://twitter.com/tinkoff_bank/status/621358467815768064" target="_blank">поняли</a>. Более того, сейчас (по моим прикидкам на исправление было потрачено около недели) на всех страницах <a href="https://www.tinkoff.ru/statement/" target="_blank">https://www.tinkoff.ru/statement/*</a> вообще никаких сторонних сервисов больше нет, хотя с главной страницы сайта банка они, конечно, никуда не делись.

В целом, молодцы, что исправили, но плохо, что не позаботились об этом заранее. В конце концов, нет же никаких Google Analytics и прочих средств слежения за пользователем в Личном кабинете их Интернет-банка. Надеюсь, что г-н Оливер Хьюз будет следить за соблюдением <a href="https://www.tinkoff.ru/about/news/22072015-best-online-bank-global-finance/" target="_blank">озвученных им принципов</a>: «<em>Мы являемся единственным полностью дистанционным банком в России, поэтому развитие онлайн-каналов — наш приоритет, и мы инвестируем много времени и ресурсов, чтобы довести их до совершенства</em>».

В конце концов, даже <a href="http://izvestia.ru/news/588948" target="_blank">в Минэкономразвития всю опасность сторонних счётчиков понимают</a>, там, правда, мотивация чуть другая =)

[box type="info" style="rounded"]UPD. 24.07.2015 Как подсказывают в <a href="https://www.facebook.com/e.v.rodigin/posts/697451770388448" target="_blank">Facebook</a> коллеги из Лаборатории Касперского, вероятно, проблема не была настолько опасна: настройки предполагали, что ссылка должна открываться без авторизации только на тех устройствах, с которых пользователь ранее входил в Интернет-банк. Достоверно проверить сейчас данный факт уже не представляется возможным (все ссылки на выписки недействительны). С другой стороны, наличие любых запросов со страницы с конфиденциальной информацией к каким бы то ни было сторонним сервисам не желательно в любом случае.[/box]

[box type="info" style="rounded"]UPD. 17.08.2015 Появилась возможность проверить справедливость моих опасений и не преминул это сделать: <a href="https://zlonov.ru/2015/08/i-do-not-believe-you/">Как я проверял, что уязвимость у Банка Тинькофф была уязвимостью</a>.[/box]

В заключение порекомендую два отличных расширения для браузеров: <a href="https://www.ghostery.com/en/try-us/download-add-on/" target="_blank">Ghostery</a> и <a href="https://getadblock.com" target="_blank">AdBlock</a>, которые в описанном выше случае (пока я их не отключил для проведения тестов) прекрасно справлялись с проблемой.

Ghostery специализируется как раз на блокировке сервисов по слежению за пользователями и в работе очень информативен и удобен: для каждой страницы можно быстро посмотреть обнаруженные "жучки" и при необходимости некоторые из них разрешить (бывает нужно, например, для автоматической авторизации с использованием профиля соцсети).

[caption id="attachment_7217" align="aligncenter" width="550"]<a href="/assets/uploads/Ghostery-vs-Tinkoff-Bank.png"><img class="wp-image-7217" src="/assets/uploads/Ghostery-vs-Tinkoff-Bank.png" alt="Ghostery vs Tinkoff Bank" width="550" height="296" /></a> Ghostery vs Tinkoff Bank[/caption]

Единственный недостаток Ghostery - не очень полная база, особенно для русскоязычного сегмента Интернет. Даже на примере страницы банка Тинькофф видно, что Ghostery выявил только два жучка.

AdBlock, наверное, популярнее и уже знаком многим как отличное средство борьбы с рекламой (а её <a href="https://twitter.com/zlonov/status/559633629270528000/photo/1" target="_blank">в сети хватает</a>), но это не единственный его функционал. В настройках можно включить дополнительные списки фильтров для блокировки:

[caption id="attachment_7218" align="aligncenter" width="550"]<a href="/assets/uploads/Списки-фильтров-AdBlock.png"><img class="wp-image-7218" src="/assets/uploads/Списки-фильтров-AdBlock.png" alt="Списки фильтров AdBlock" width="550" height="256" /></a> Списки фильтров AdBlock[/caption]

Впрочем, если выбрать вообще все списки, то часть привычного функционала на многих сайтах может пропасть, так что в крайность впадать тоже не обязательно.

Ещё материалы по теме:
<ul>
	<li><a href="http://habrahabr.ru/post/262695/" target="_blank">ЯндексБот ходит по ссылкам, по которым ходит пользователь</a>, ХабраХабр</li>
	<li><a href="http://izvestia.ru/news/588948" target="_blank">С официальных сайтов уберут иностранные счетчики посещаемости</a>, Известия</li>
	<li><a href="https://zlonov.ru/2012/02/almost_hacked_alfa-bank/" target="_blank">Как я чуть не "взломал" Альфа-Банк</a>, ZLONOV.ru</li>
	<li><a href="https://zlonov.ru/2015/07/why-dlp-did-not-protect-against-leakage/" target="_blank">Почему DLP-система не защитила банк Санкт-Петербург от утечки?</a>, ZLONOV.ru</li>
</ul>
<p style="text-align: right;"><sub><em><a href="http://icdn.lenta.ru/images/2013/08/08/17/20130808170128276/detail_f72bc5fee08b8be1e497b10242e19284.jpg" target="_blank">Изображение</a></em></sub>
&nbsp;
